name: Build Swiftgram Pro Mod
on:
  workflow_dispatch:

jobs:
  build:
    runs-on: macos-14
    steps:
      - uses: actions/checkout@v4
        with:
          submodules: 'recursive'
          fetch-depth: 1

      - name: Inject Features
        run: bash full_mod_patch.sh # Применяем наш патч

      - name: Setup Signing
        run: |
          # ВСТАВЬ СЮДА СВОЙ БЛОК ИМПОРТА СЕРТИФИКАТА (p12 и профиль)
          # Используй тот код, который мы настраивали для ключей.

      - name: Build IPA
        run: |
          python3 build-system/Make/Make.py \
            --overrideXcodeVersion \
            build \
            --configuration=release_arm64 \
            --codesigningInformationPath=build-system/fake-codesigning

      - name: Upload
        uses: actions/upload-artifact@v4
        with:
          name: Swiftgram-Ultimate-Pro
          path: build/artifacts/*.ipa
